# iOS - DrawingApp



## Step5. 드래그 기능 구현

### :pushpin:주요 작업 내용

- [x] 뷰의 추상 타입과 모델의 추상 타입에 해당 타입 객체의 좌표(Point)를 이동시키는 메서드 추가
- [x] 뷰의 추상 타입에 객체를 복사하는 메서드 추가
	- [x] 리뷰 후에 해당 메서드를 NSCopying 프로토콜을 채택함으로써 구현해야하는 `Copy()` 메서드로 변경

- [x] ViewController의 drawableAreaView에 Pan Gesture 기능 구현
	- [x] 뷰가 움직일 때 해당 뷰와 alpha가 0.5이고 크기, 색이 동일한 뷰를 복사하여, 이동할 때 복사된 뷰가 움직이고, 이동이 완료되면 기존의 뷰를 복사된 뷰의 위치로 이동시키는 기능 추가


---

### :computer:작업 진행과정

1. 뷰의 추상 타입에 해당하는 RectangleViewable 프로토콜과 모델의 추상 타입에 해당하는 Rectangularable 프로토콜에 객체의 좌표를 이동시킬 수 있는 메서드를 추가
2. 뷰의 이동을 위해, 뷰를 복사할 수 있는 메서드 `copyToNewInstatnce()` 를 RectangleViewable 프로토콜에 추가
3. UIPanGestureRecognizer를 이용해 사용자의 손가락이 드래그(Pan)되는 움직임을 인식하여, 선택된 사각형 뷰를 이동시키는 기능 구현
	1. UIPanGestureRecognizer의 state 3개로 동작을 나누어 사각형 뷰를 이동시키도록 구현
	2. 사각형 뷰가 움직이기 시작하면 해당 뷰가 복사되어 새로운 temporaryView를 만들어 사용자의 드래그를 따라 움직이도록 설정
	3. 움직임이 끝나면 이동한 temporaryView의 위치로 원래의 사각형 뷰를 이동시키고, 사각형 뷰와 매칭되는 사각형 객체도 함께 이동하도록 설정

4. Refactoring
	1. NSCopying 프로토콜을 RectangleViewable 프로토콜이 채택함으로 따라, 복사를 위한 메서드를 해당 프로토콜에 정의되어 있는 `copy()` 메서드로 변경
	2. Pan Gesture 이벤트의 입출력 흐름을 구분
	3. 배경색 변경이 불가능할 경우 배경색 버튼을 Hidden 상태가 되도록 처리했던 것을 Disable 상태가 되도록 변경


>완성 일시: 2022.03.17 01:30

---

### :clipboard:프로그램 동작 화면

1. `사각형 생성` 에 해당하는 버튼을 누르면 임의의 좌표에 임의의 배경색, 임의의 투명도를 가진 사각형이 생성됩니다.
2. 생성된 사각형을 터치하면 오른쪽의 `배경색 버튼` 과 `투명도 조절 버튼`, 그리고 `투명도 조절 슬라이더` 가 활성화됩니다.
	1. `배경색 버튼`을 누르면 선택된 사각형의 **배경색**이 랜덤으로 변경됩니다.
	2. `투명도 버튼`을 누르거나, `투명도 슬라이더` 를 조절하면 선택된 사각형의 **투명도**가 변경됩니다.
3. 빈공간을 터치하면 오른쪽의 버튼, 슬라이더가 비활성화됩니다.
4. `사진 생성` 에 해당하는 버튼을 누르면 ImagePicker가 등장하게 되고, 이미지를 선택한 후 `Use` 버튼을 누르면 임의의 좌표에 임의의 투명도를 가진 사진 사각형이 생성됩니다.
5. 생성된 사진 사각형을 터치하면 오른쪽의 `투명도 조절 버튼`, `투명도 조절 슬라이더`가 활성화되고, `배경색 버튼`은 비활성화(숨겨짐) 됩니다.
	1. `투명도 버튼`을 누르거나, `투명도 슬라이더`를 조절하면 선택된 사각형의 **투명도**가 변경됩니다.

6. 두 손가락을 이용해 사각형을 이동시킬 수 있습니다.
	1. 이동 시에는 선택된 뷰를 임시로 복사하여 움직임을 볼 수 있고, 이동이 끝나면 복사된 뷰는 제거되고 선택된 뷰가 해당 위치로 이동합니다.

<img src="https://user-images.githubusercontent.com/92504186/158521188-12d0840a-fba2-4931-a356-9115ea63c823.gif" alt="SS 2022-03-16 PM 02 10 07" width="50%;" />